<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/ais.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/logo.jpg">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.1/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"carl-wang-cn.github.io","root":"/","images":"/images","scheme":"Mist","version":"8.2.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}};
  </script>
<meta name="description" content="查看已存在的数据库12345678910111213141516171819MariaDB [carltest]&gt; show databases;+-------------------------+| Database                |+-------------------------+| carltest                || test">
<meta property="og:type" content="article">
<meta property="og:title" content="我的MySQL速查手册">
<meta property="og:url" content="https://carl-wang-cn.github.io/2020/12/27/mysql-manual/index.html">
<meta property="og:site_name" content="carl的修行">
<meta property="og:description" content="查看已存在的数据库12345678910111213141516171819MariaDB [carltest]&gt; show databases;+-------------------------+| Database                |+-------------------------+| carltest                || test">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2020-12-27T08:02:49.000Z">
<meta property="article:modified_time" content="2024-07-31T07:20:05.945Z">
<meta property="article:author" content="carl">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://carl-wang-cn.github.io/2020/12/27/mysql-manual/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>
<title>我的MySQL速查手册 | carl的修行</title>
  




  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="carl的修行" type="application/atom+xml">
<link rel="alternate" href="/rss2.xml" title="carl的修行" type="application/rss+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">carl的修行</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">坚持做正确的事情, 做时间的朋友</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-about"><a href="/about" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
        <li class="menu-item menu-item-commonweal"><a href="/404/" rel="section"><i class="fa fa-heartbeat fa-fw"></i>公益 404</a></li>
        <li class="menu-item menu-item-reading"><a href="/reading" rel="section"><i class="fa fa-book fa-fw"></i>reading</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E5%B7%B2%E5%AD%98%E5%9C%A8%E7%9A%84%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-number">1.</span> <span class="nav-text">查看已存在的数据库</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%9F%A5%E8%AF%A2%E9%BB%98%E8%AE%A4%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E"><span class="nav-number">2.</span> <span class="nav-text">查询默认存储引擎</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-number">3.</span> <span class="nav-text">创建数据库</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-number">4.</span> <span class="nav-text">删除数据库</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%AE%BE%E7%BD%AE%E8%A1%A8%E7%9A%84%E4%B8%BB%E9%94%AE"><span class="nav-number">5.</span> <span class="nav-text">设置表的主键</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E7%B4%A2%E5%BC%95"><span class="nav-number">6.</span> <span class="nav-text">创建索引</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9F%A5%E8%AF%A2"><span class="nav-number"></span> <span class="nav-text">查询</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%9F%A5%E8%AF%A2%E8%AF%AD%E5%8F%A5"><span class="nav-number">1.</span> <span class="nav-text">基本查询语句</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%85%88%E5%87%86%E5%A4%87%E7%82%B9%E6%95%B0%E6%8D%AE-%E8%A6%81%E4%B8%8D%E7%84%B6%E4%B8%8B%E9%9D%A2%E7%9A%84%E6%88%8F%E6%B2%A1%E6%B3%95%E5%94%B1%E4%BA%86"><span class="nav-number">2.</span> <span class="nav-text">先准备点数据, 要不然下面的戏没法唱了.</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#LIMIT%E9%99%90%E5%AE%9A"><span class="nav-number">3.</span> <span class="nav-text">LIMIT限定</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#IN%E5%85%B3%E9%94%AE%E5%AD%97"><span class="nav-number">4.</span> <span class="nav-text">IN关键字</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#GROUP-BY%E5%85%B3%E9%94%AE%E5%AD%97"><span class="nav-number">5.</span> <span class="nav-text">GROUP BY关键字</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%B5%8C%E5%A5%97%E6%9F%A5%E8%AF%A2"><span class="nav-number">6.</span> <span class="nav-text">嵌套查询</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#UNION-UNION-ALL%E7%94%A8%E6%B3%95"><span class="nav-number">7.</span> <span class="nav-text">UNION, UNION ALL用法</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ANY%E5%85%B3%E9%94%AE%E5%AD%97"><span class="nav-number">8.</span> <span class="nav-text">ANY关键字</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%8C%B9%E9%85%8D%E6%9F%A5%E8%AF%A2"><span class="nav-number">9.</span> <span class="nav-text">正则表达式匹配查询</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="nav-number">10.</span> <span class="nav-text">连接查询</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8F%92%E5%85%A5-%E6%9B%B4%E6%96%B0-%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE"><span class="nav-number"></span> <span class="nav-text">插入, 更新, 删除数据</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%85%88%E5%BB%BA%E4%B8%80%E5%BC%A0%E8%A1%A8-%E6%8E%A5%E4%B8%8B%E6%9D%A5%E7%94%A8%E6%9D%A5%E6%93%8D%E4%BD%9C"><span class="nav-number">1.</span> <span class="nav-text">先建一张表, 接下来用来操作</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8F%92%E5%85%A5%E6%95%B0%E6%8D%AE"><span class="nav-number"></span> <span class="nav-text">插入数据</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#INSERT%E8%AF%AD%E5%8F%A5%E4%B8%AD%E4%B8%8D%E6%8C%87%E5%AE%9A%E5%85%B7%E4%BD%93%E7%9A%84%E5%AD%97%E6%AE%B5%E5%90%8D"><span class="nav-number">1.</span> <span class="nav-text">INSERT语句中不指定具体的字段名</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%8F%92%E5%85%A5%E6%8C%87%E5%AE%9A%E5%88%97"><span class="nav-number">2.</span> <span class="nav-text">插入指定列</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%90%8C%E6%97%B6%E6%8F%92%E5%85%A5%E5%A4%9A%E8%A1%8C%E6%95%B0%E6%8D%AE"><span class="nav-number">3.</span> <span class="nav-text">同时插入多行数据</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%B0%86%E6%9F%A5%E8%AF%A2%E7%BB%93%E6%9E%9C%E6%8F%92%E5%85%A5%E5%88%B0%E8%A1%A8%E4%B8%AD"><span class="nav-number">4.</span> <span class="nav-text">将查询结果插入到表中</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9B%B4%E6%96%B0%E6%95%B0%E6%8D%AE"><span class="nav-number"></span> <span class="nav-text">更新数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE"><span class="nav-number"></span> <span class="nav-text">删除数据</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A1%A8%E7%BB%93%E6%9E%84%E4%BF%AE%E6%94%B9"><span class="nav-number"></span> <span class="nav-text">表结构修改</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E8%A1%A8%E5%90%8D"><span class="nav-number"></span> <span class="nav-text">修改表名</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B7%BB%E5%8A%A0%E5%88%97"><span class="nav-number"></span> <span class="nav-text">添加列</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E5%88%97"><span class="nav-number"></span> <span class="nav-text">修改列</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E5%88%97"><span class="nav-number"></span> <span class="nav-text">删除列</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9unique-key"><span class="nav-number"></span> <span class="nav-text">修改unique key</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86"><span class="nav-number"></span> <span class="nav-text">权限管理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#mysql-user%E8%A1%A8"><span class="nav-number"></span> <span class="nav-text">mysql.user表</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E5%88%97%E4%B8%AD%E6%9C%89%E5%BE%88%E5%A4%9A%E6%9D%83%E9%99%90%E5%AD%97%E6%AE%B5%E9%9C%80%E8%A6%81%E7%89%B9%E5%88%AB%E6%B3%A8%E6%84%8F"><span class="nav-number">1.</span> <span class="nav-text">权限列中有很多权限字段需要特别注意:</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#user%E8%A1%A8%E7%9A%84%E8%B5%84%E6%BA%90%E6%8E%A7%E5%88%B6%E5%88%97"><span class="nav-number">2.</span> <span class="nav-text">user表的资源控制列</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%94%A8%E6%88%B7%E8%B4%A6%E5%8F%B7%E7%9B%B8%E5%85%B3"><span class="nav-number"></span> <span class="nav-text">用户账号相关</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%96%B0%E5%BB%BA%E6%99%AE%E9%80%9A%E7%94%A8%E6%88%B7"><span class="nav-number">1.</span> <span class="nav-text">新建普通用户</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E6%99%AE%E9%80%9A%E7%94%A8%E6%88%B7"><span class="nav-number">2.</span> <span class="nav-text">删除普通用户</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#root%E7%94%A8%E6%88%B7%E4%BF%AE%E6%94%B9root%E7%94%A8%E6%88%B7%E7%9A%84%E5%AF%86%E7%A0%81"><span class="nav-number">3.</span> <span class="nav-text">root用户修改root用户的密码</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#root%E7%94%A8%E6%88%B7%E4%BF%AE%E6%94%B9%E6%99%AE%E9%80%9A%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81"><span class="nav-number">4.</span> <span class="nav-text">root用户修改普通用户密码</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%99%AE%E9%80%9A%E7%94%A8%E6%88%B7%E4%BF%AE%E6%94%B9%E5%AF%86%E7%A0%81"><span class="nav-number">5.</span> <span class="nav-text">普通用户修改密码</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MySQL%E7%9A%84%E5%90%84%E7%A7%8D%E6%9D%83%E9%99%90"><span class="nav-number"></span> <span class="nav-text">MySQL的各种权限</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8E%88%E6%9D%83%E4%B8%8E%E6%94%B6%E5%9B%9E%E6%9D%83%E9%99%90"><span class="nav-number"></span> <span class="nav-text">授权与收回权限</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%8E%88%E6%9D%83"><span class="nav-number">1.</span> <span class="nav-text">授权</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%94%B6%E5%9B%9E%E6%9D%83%E9%99%90"><span class="nav-number">2.</span> <span class="nav-text">收回权限</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E6%9D%83%E9%99%90"><span class="nav-number">3.</span> <span class="nav-text">查看权限</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%A4%87%E4%BB%BD%E4%B8%8E%E8%BF%98%E5%8E%9F"><span class="nav-number"></span> <span class="nav-text">数据备份与还原</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8mysqldump%E5%91%BD%E4%BB%A4%E5%A4%87%E4%BB%BD"><span class="nav-number"></span> <span class="nav-text">使用mysqldump命令备份</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%A4%87%E4%BB%BD%E4%B8%80%E4%B8%AA%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-number">1.</span> <span class="nav-text">备份一个数据库</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%A4%87%E4%BB%BD%E5%A4%9A%E4%B8%AA%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-number">2.</span> <span class="nav-text">备份多个数据库</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%A4%87%E4%BB%BD%E6%89%80%E6%9C%89%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-number">3.</span> <span class="nav-text">备份所有数据库</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9B%B4%E6%8E%A5%E5%A4%8D%E5%88%B6%E6%95%B4%E4%B8%AA%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9B%AE%E5%BD%95"><span class="nav-number"></span> <span class="nav-text">直接复制整个数据库目录</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E8%BF%98%E5%8E%9F"><span class="nav-number"></span> <span class="nav-text">数据还原</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8mysql%E5%91%BD%E4%BB%A4%E8%BF%98%E5%8E%9F"><span class="nav-number">1.</span> <span class="nav-text">使用mysql命令还原</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%9B%B4%E6%8E%A5%E5%A4%8D%E5%88%B6%E6%95%B4%E4%B8%AA%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9B%AE%E5%BD%95-1"><span class="nav-number">2.</span> <span class="nav-text">直接复制整个数据库目录</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB"><span class="nav-number"></span> <span class="nav-text">数据迁移</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A1%A8%E7%9A%84%E5%AF%BC%E5%85%A5%E5%AF%BC%E5%87%BA"><span class="nav-number"></span> <span class="nav-text">表的导入导出</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AF%BC%E5%87%BA"><span class="nav-number">1.</span> <span class="nav-text">导出</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AF%BC%E5%85%A5"><span class="nav-number">2.</span> <span class="nav-text">导入</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%97%A5%E5%BF%97"><span class="nav-number"></span> <span class="nav-text">日志</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%97%A5%E5%BF%97-bin-log"><span class="nav-number"></span> <span class="nav-text">二进制日志(bin log)</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%90%AF%E5%8A%A8%E5%92%8C%E8%AE%BE%E7%BD%AEbin-log"><span class="nav-number">1.</span> <span class="nav-text">启动和设置bin log</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8Bbin-log"><span class="nav-number">2.</span> <span class="nav-text">查看bin log</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8bin-log%E6%9D%A5%E8%BF%98%E5%8E%9F%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-number">3.</span> <span class="nav-text">使用bin log来还原数据库</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%9A%82%E5%81%9C%E5%92%8C%E9%87%8D%E5%90%AFbin-log%E5%8A%9F%E8%83%BD"><span class="nav-number">4.</span> <span class="nav-text">暂停和重启bin log功能</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%94%99%E8%AF%AF%E6%97%A5%E5%BF%97-error-log"><span class="nav-number"></span> <span class="nav-text">错误日志(error log)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%9A%E7%94%A8%E6%9F%A5%E8%AF%A2%E6%97%A5%E5%BF%97"><span class="nav-number"></span> <span class="nav-text">通用查询日志</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%85%A2%E6%9F%A5%E8%AF%A2%E6%97%A5%E5%BF%97"><span class="nav-number"></span> <span class="nav-text">慢查询日志</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E7%9A%84%E6%9C%89%E5%85%B3%E6%A6%82%E5%BF%B5"><span class="nav-number"></span> <span class="nav-text">性能优化的有关概念</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BC%98%E5%8C%96%E7%AE%80%E4%BB%8B"><span class="nav-number"></span> <span class="nav-text">优化简介</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BC%98%E5%8C%96%E6%9F%A5%E8%AF%A2"><span class="nav-number"></span> <span class="nav-text">优化查询</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E6%9E%90%E6%9F%A5%E8%AF%A2%E8%AF%AD%E5%8F%A5"><span class="nav-number"></span> <span class="nav-text">分析查询语句</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E7%B4%A2%E5%BC%95%E6%9F%A5%E8%AF%A2"><span class="nav-number"></span> <span class="nav-text">使用索引查询</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%B3%A8%E6%84%8F%E4%B8%8B%E9%9D%A2%E6%B7%BB%E5%8A%A0%E7%B4%A2%E5%BC%95%E5%89%8D%E5%90%8E-%E4%B8%A4%E6%AC%A1%E6%8F%92%E5%8F%99-rows%E7%9A%84%E7%BB%93%E6%9E%9C-%E4%B8%80%E4%B8%AA%E4%B8%BA4-%E4%B8%80%E4%B8%AA%E4%B8%BA1"><span class="nav-number">1.</span> <span class="nav-text">注意下面添加索引前后, 两次插叙 rows的结果, 一个为4, 一个为1.</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#LIKE%E5%85%B3%E9%94%AE%E5%AD%97%E7%9A%84%E4%BD%BF%E7%94%A8%E6%96%B9%E5%BC%8F-%E5%A6%82%E6%9E%9C%E5%8C%B9%E9%85%8D%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AA%E5%AD%97%E7%AC%A6%E4%B8%BA%E2%80%99-%E2%80%99-%E7%B4%A2%E5%BC%95%E4%B8%8D%E4%BC%9A%E8%A2%AB%E4%BD%BF%E7%94%A8-%E5%90%A6%E5%88%99-%E7%B4%A2%E5%BC%95%E4%BC%9A%E8%A2%AB%E4%BD%BF%E7%94%A8"><span class="nav-number">2.</span> <span class="nav-text">LIKE关键字的使用方式. 如果匹配字符串的第一个字符为’%’, 索引不会被使用, 否则, 索引会被使用</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%A4%9A%E5%88%97%E7%B4%A2%E5%BC%95%E7%9A%84%E7%94%A8%E6%B3%95-%E5%8F%AA%E6%9C%89%E6%9F%A5%E8%AF%A2%E6%9D%A1%E4%BB%B6%E4%B8%AD%E4%BD%BF%E7%94%A8%E4%BA%86%E8%BF%99%E4%BA%9B%E5%AD%97%E6%AE%B5%E4%B8%AD%E7%AC%AC%E4%B8%80%E4%B8%AA%E5%AD%97%E6%AE%B5%E6%97%B6-%E7%B4%A2%E5%BC%95%E6%89%8D%E4%BC%9A%E8%A2%AB%E4%BD%BF%E7%94%A8"><span class="nav-number">3.</span> <span class="nav-text">多列索引的用法. 只有查询条件中使用了这些字段中第一个字段时, 索引才会被使用.</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#OR%E5%85%B3%E9%94%AE%E5%AD%97%E7%B4%A2%E5%BC%95%E7%94%A8%E6%B3%95-OR%E5%89%8D%E5%90%8E%E4%B8%A4%E4%B8%AA%E6%9D%A1%E4%BB%B6%E7%9A%84%E5%88%97%E9%83%BD%E6%98%AF%E7%B4%A2%E5%BC%95%E6%97%B6-%E6%9F%A5%E8%AF%A2%E5%B0%86%E4%BD%BF%E7%94%A8%E7%B4%A2%E5%BC%95-%E5%8F%AA%E8%A6%81%E6%9C%89%E4%B8%80%E5%88%97%E4%B8%8D%E6%98%AF%E7%B4%A2%E5%BC%95-%E9%82%A3%E4%B9%88%E6%9F%A5%E8%AF%A2%E5%B0%B1%E4%B8%8D%E4%BC%9A%E4%BD%BF%E7%94%A8%E7%B4%A2%E5%BC%95"><span class="nav-number">4.</span> <span class="nav-text">OR关键字索引用法. OR前后两个条件的列都是索引时, 查询将使用索引. 只要有一列不是索引, 那么查询就不会使用索引</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#MySQL%E5%8F%82%E6%95%B0%E4%BC%98%E5%8C%96"><span class="nav-number">5.</span> <span class="nav-text">MySQL参数优化</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="carl"
      src="/images/ais.jpg">
  <p class="site-author-name" itemprop="name">carl</p>
  <div class="site-description" itemprop="description">金融程序员</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
        
          <span class="site-state-item-count">43</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories">
          
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags">
          
        <span class="site-state-item-count">33</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/carl-wang-cn" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;carl-wang-cn" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:carl.king.cn@gmail.com" title="E-Mail → mailto:carl.king.cn@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://carl-wang-cn.github.io/2020/12/27/mysql-manual/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/ais.jpg">
      <meta itemprop="name" content="carl">
      <meta itemprop="description" content="金融程序员">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="carl的修行">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          我的MySQL速查手册
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-12-27 16:02:49" itemprop="dateCreated datePublished" datetime="2020-12-27T16:02:49+08:00">2020-12-27</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2024-07-31 15:20:05" itemprop="dateModified" datetime="2024-07-31T15:20:05+08:00">2024-07-31</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%8A%80%E6%9C%AF/" itemprop="url" rel="index"><span itemprop="name">技术</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h5 id="查看已存在的数据库"><a href="#查看已存在的数据库" class="headerlink" title="查看已存在的数据库"></a>查看已存在的数据库</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [carltest]&gt; show databases;</span><br><span class="line">+-------------------------+</span><br><span class="line">| Database                |</span><br><span class="line">+-------------------------+</span><br><span class="line">| carltest                |</span><br><span class="line">| <span class="built_in">test</span>                    |</span><br><span class="line">| test2                   |</span><br><span class="line">| test3                   |</span><br><span class="line">| test_insert             |</span><br><span class="line">+-------------------------+</span><br><span class="line">5 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [carltest]&gt; show databases like <span class="string">&#x27;carl%&#x27;</span>;</span><br><span class="line">+------------------+</span><br><span class="line">| Database (carl%) |</span><br><span class="line">+------------------+</span><br><span class="line">| carltest         |</span><br><span class="line">+------------------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br></pre></td></tr></table></figure>

<span id="more"></span>

<h5 id="查询默认存储引擎"><a href="#查询默认存储引擎" class="headerlink" title="查询默认存储引擎"></a>查询默认存储引擎</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [(none)]&gt; show variables like <span class="string">&#x27;storage_engine&#x27;</span>;</span><br><span class="line">+----------------+--------+</span><br><span class="line">| Variable_name  | Value  |</span><br><span class="line">+----------------+--------+</span><br><span class="line">| storage_engine | InnoDB |</span><br><span class="line">+----------------+--------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt;</span><br></pre></td></tr></table></figure>

<h5 id="创建数据库"><a href="#创建数据库" class="headerlink" title="创建数据库"></a>创建数据库</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">CREATE &#123;DATABASE | SCHEMA&#125; [IF NOT EXISTS] db_name</span><br><span class="line">    [create_specification] ...</span><br><span class="line"></span><br><span class="line">create_specification:</span><br><span class="line">    [DEFAULT] CHARACTER SET [=] charset_name</span><br><span class="line">  | [DEFAULT] COLLATE [=] collation_name</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个utf8编码的database</span></span><br><span class="line">MariaDB [(none)]&gt; create database carltest</span><br><span class="line">    -&gt; default character <span class="built_in">set</span> utf8</span><br><span class="line">    -&gt; default collate utf8_general_ci;</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; show databases like <span class="string">&#x27;carl%&#x27;</span>;</span><br><span class="line">+------------------+</span><br><span class="line">| Database (carl%) |</span><br><span class="line">+------------------+</span><br><span class="line">| carltest         |</span><br><span class="line">+------------------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt;</span><br></pre></td></tr></table></figure>

<h5 id="删除数据库"><a href="#删除数据库" class="headerlink" title="删除数据库"></a>删除数据库</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [(none)]&gt; show databases like <span class="string">&#x27;carl%&#x27;</span>;</span><br><span class="line">+------------------+</span><br><span class="line">| Database (carl%) |</span><br><span class="line">+------------------+</span><br><span class="line">| carltest         |</span><br><span class="line">+------------------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; drop database carltest;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; show databases like <span class="string">&#x27;carl%&#x27;</span>;</span><br><span class="line">Empty <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt;</span><br></pre></td></tr></table></figure>

<h5 id="设置表的主键"><a href="#设置表的主键" class="headerlink" title="设置表的主键"></a>设置表的主键</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 单字段主键, 可以直接指定, 如下示例</span></span><br><span class="line">&gt; create table <span class="keyword">if</span> not exists test1(<span class="built_in">id</span> int primary key,</span><br><span class="line">&gt;                                  name varchar(20),</span><br><span class="line">&gt;                                  sex boolean</span><br><span class="line">&gt;                                  );</span><br><span class="line"></span><br><span class="line"><span class="comment"># 多字段主键</span></span><br><span class="line">&gt; create table <span class="keyword">if</span> not exists test1(stu_id int,</span><br><span class="line">&gt;                                  couse_id int,</span><br><span class="line">&gt;                                  grade <span class="built_in">float</span>,</span><br><span class="line">&gt;                                  primary key(stu_id, course_id),</span><br><span class="line">&gt;                                  );</span><br></pre></td></tr></table></figure>


<h5 id="创建索引"><a href="#创建索引" class="headerlink" title="创建索引"></a>创建索引</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [carltest]&gt; create table <span class="keyword">if</span> not exists user(userid int(10) unique primary key auto_increment,</span><br><span class="line">    -&gt; username varchar(20) not null,</span><br><span class="line">    -&gt; passwd varchar(20) not null,</span><br><span class="line">    -&gt; info text,</span><br><span class="line">    -&gt; unique index index_uid(userid desc),</span><br><span class="line">    -&gt; index index_user(username, passwd),</span><br><span class="line">    -&gt; fulltext index index_info(info)</span><br><span class="line">    -&gt; ) engine=myisam;</span><br><span class="line"></span><br><span class="line">Query OK, 0 rows affected (0.17 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [carltest]&gt; show create table user \G</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">       Table: user</span><br><span class="line">Create Table: CREATE TABLE `user` (</span><br><span class="line">  `userid` int(10) NOT NULL AUTO_INCREMENT,</span><br><span class="line">  `username` varchar(20) NOT NULL,</span><br><span class="line">  `passwd` varchar(20) NOT NULL,</span><br><span class="line">  `info` text,</span><br><span class="line">  PRIMARY KEY (`userid`),</span><br><span class="line">  UNIQUE KEY `index_uid` (`userid`),</span><br><span class="line">  KEY `index_user` (`username`,`passwd`),</span><br><span class="line">  FULLTEXT KEY `index_info` (`info`)</span><br><span class="line">) ENGINE=MyISAM DEFAULT CHARSET=utf8</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建单列索引</span></span><br><span class="line">MariaDB [carltest]&gt; create index index_name on information(name(10));</span><br><span class="line">Query OK, 0 rows affected (0.31 sec)</span><br><span class="line">Records: 0  Duplicates: 0  Warnings: 0</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建多列索引</span></span><br><span class="line">MariaDB [carltest]&gt; create index index_bir on information(birthday, address);</span><br><span class="line">Query OK, 0 rows affected (0.02 sec)</span><br><span class="line">Records: 0  Duplicates: 0  Warnings: 0</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用alter语句创建索引</span></span><br><span class="line">MariaDB [carltest]&gt; alter table information add index index_id(<span class="built_in">id</span> asc);</span><br><span class="line">Query OK, 0 rows affected (0.02 sec)</span><br><span class="line">Records: 0  Duplicates: 0  Warnings: 0</span><br><span class="line"></span><br><span class="line">MariaDB [carltest]&gt; show create table information \G;</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">       Table: information</span><br><span class="line">Create Table: CREATE TABLE `information` (</span><br><span class="line">  `<span class="built_in">id</span>` int(10) NOT NULL AUTO_INCREMENT,</span><br><span class="line">  `name` varchar(20) NOT NULL,</span><br><span class="line">  `sex` varchar(4) NOT NULL,</span><br><span class="line">  `birthday` <span class="built_in">date</span> DEFAULT NULL,</span><br><span class="line">  `address` varchar(50) DEFAULT NULL,</span><br><span class="line">  `tel` varchar(20) DEFAULT NULL,</span><br><span class="line">  `pic` blob,</span><br><span class="line">  PRIMARY KEY (`<span class="built_in">id</span>`),</span><br><span class="line">  KEY `index_name` (`name`(10)),</span><br><span class="line">  KEY `index_bir` (`birthday`,`address`),</span><br><span class="line">  KEY `index_id` (`<span class="built_in">id</span>`)</span><br><span class="line">) ENGINE=InnoDB DEFAULT CHARSET=utf8</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除索引</span></span><br><span class="line">MariaDB [carltest]&gt; drop index index_user on user;</span><br><span class="line">Query OK, 0 rows affected (0.44 sec)</span><br><span class="line">Records: 0  Duplicates: 0  Warnings: 0</span><br><span class="line"></span><br><span class="line">MariaDB [carltest]&gt; show create table user \G</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">       Table: user</span><br><span class="line">Create Table: CREATE TABLE `user` (</span><br><span class="line">  `userid` int(10) NOT NULL AUTO_INCREMENT,</span><br><span class="line">  `username` varchar(20) NOT NULL,</span><br><span class="line">  `passwd` varchar(20) NOT NULL,</span><br><span class="line">  `info` text,</span><br><span class="line">  PRIMARY KEY (`userid`),</span><br><span class="line">  UNIQUE KEY `index_uid` (`userid`),</span><br><span class="line">  FULLTEXT KEY `index_info` (`info`)</span><br><span class="line">) ENGINE=MyISAM DEFAULT CHARSET=utf8</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [carltest]&gt;</span><br></pre></td></tr></table></figure>

<h2 id="查询"><a href="#查询" class="headerlink" title="查询"></a>查询</h2><h5 id="基本查询语句"><a href="#基本查询语句" class="headerlink" title="基本查询语句"></a>基本查询语句</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT 属性列表</span><br><span class="line">       FROM 表名</span><br><span class="line">       [WHERE XXXX]</span><br><span class="line">       [GROUP BY 属性名1, 属性名2 [, 属性名i ...] [HAVING 条件表达式]]</span><br><span class="line">       [ORDER BY 属性名3 [ASC | DESC]]</span><br><span class="line">       [LIMIT 初始位置, 记录数]</span><br></pre></td></tr></table></figure>

<h5 id="先准备点数据-要不然下面的戏没法唱了"><a href="#先准备点数据-要不然下面的戏没法唱了" class="headerlink" title="先准备点数据, 要不然下面的戏没法唱了."></a>先准备点数据, 要不然下面的戏没法唱了.</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [carltest]&gt; <span class="keyword">select</span> * from score;</span><br><span class="line">+----+--------+-----------+-------+</span><br><span class="line">| <span class="built_in">id</span> | stu_id | c_name    | grade |</span><br><span class="line">+----+--------+-----------+-------+</span><br><span class="line">|  1 |    901 | 计算机    |    98 |</span><br><span class="line">|  2 |    901 | 英语      |    80 |</span><br><span class="line">|  3 |    902 | 计算机    |    65 |</span><br><span class="line">|  4 |    902 | 中文      |    88 |</span><br><span class="line">|  5 |    903 | 中文      |    95 |</span><br><span class="line">|  6 |    904 | 计算机    |    70 |</span><br><span class="line">|  7 |    904 | 英语      |    92 |</span><br><span class="line">|  8 |    905 | 英语      |    94 |</span><br><span class="line">|  9 |    906 | 计算机    |    90 |</span><br><span class="line">| 10 |    906 | 英语      |    85 |</span><br><span class="line">+----+--------+-----------+-------+</span><br><span class="line">10 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [carltest]&gt; <span class="keyword">select</span> * from student;</span><br><span class="line">+-----+-----------+------+-------+--------------+--------------------+</span><br><span class="line">| <span class="built_in">id</span>  | name      | sex  | birth | department   | address            |</span><br><span class="line">+-----+-----------+------+-------+--------------+--------------------+</span><br><span class="line">| 901 | 张老大    | 男   |  1985 | 计算机系     | 北京市海淀区       |</span><br><span class="line">| 902 | 张老二    | 男   |  1986 | 中文系       | 北京市昌平区       |</span><br><span class="line">| 903 | 张三      | 女   |  1990 | 中文系       | 湖南省永州市       |</span><br><span class="line">| 904 | 李四      | 男   |  1990 | 英语系       | 辽宁省阜新市       |</span><br><span class="line">| 905 | 王五      | 女   |  1991 | 英语系       | 福建省厦门市       |</span><br><span class="line">| 906 | 王六      | 男   |  1988 | 计算机系     | 湖南省衡阳市       |</span><br><span class="line">+-----+-----------+------+-------+--------------+--------------------+</span><br><span class="line">6 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br></pre></td></tr></table></figure>

<h5 id="LIMIT限定"><a href="#LIMIT限定" class="headerlink" title="LIMIT限定"></a>LIMIT限定</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [carltest]&gt; SELECT * FROM student LIMIT 1, 3;</span><br><span class="line">+-----+-----------+------+-------+------------+--------------------+</span><br><span class="line">| <span class="built_in">id</span>  | name      | sex  | birth | department | address            |</span><br><span class="line">+-----+-----------+------+-------+------------+--------------------+</span><br><span class="line">| 902 | 张老二    | 男   |  1986 | 中文系     | 北京市昌平区       |</span><br><span class="line">| 903 | 张三      | 女   |  1990 | 中文系     | 湖南省永州市       |</span><br><span class="line">| 904 | 李四      | 男   |  1990 | 英语系     | 辽宁省阜新市       |</span><br><span class="line">+-----+-----------+------+-------+------------+--------------------+</span><br><span class="line">3 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br></pre></td></tr></table></figure>

<h5 id="IN关键字"><a href="#IN关键字" class="headerlink" title="IN关键字"></a>IN关键字</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [carltest]&gt; SELECT * FROM student WHERE department IN (<span class="string">&#x27;计算机系&#x27;</span>, <span class="string">&#x27;英语系&#x27;</span>);</span><br><span class="line">+-----+-----------+------+-------+--------------+--------------------+</span><br><span class="line">| <span class="built_in">id</span>  | name      | sex  | birth | department   | address            |</span><br><span class="line">+-----+-----------+------+-------+--------------+--------------------+</span><br><span class="line">| 901 | 张老大    | 男   |  1985 | 计算机系     | 北京市海淀区       |</span><br><span class="line">| 904 | 李四      | 男   |  1990 | 英语系       | 辽宁省阜新市       |</span><br><span class="line">| 905 | 王五      | 女   |  1991 | 英语系       | 福建省厦门市       |</span><br><span class="line">| 906 | 王六      | 男   |  1988 | 计算机系     | 湖南省衡阳市       |</span><br><span class="line">+-----+-----------+------+-------+--------------+--------------------+</span><br><span class="line">4 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br></pre></td></tr></table></figure>

<h5 id="GROUP-BY关键字"><a href="#GROUP-BY关键字" class="headerlink" title="GROUP BY关键字"></a>GROUP BY关键字</h5><p>GROUP BY关键字通常与集合函数一起使用. 集合函数包括COUNT(), SUM(), AVG(), MAX()和MIN()等.</p>
<p>如果GROUP BY不与上述函数一起使用, 那么查询结果就是字段取值的分组情况. 字段中取值相同的记录为一组,<br>但只显示该组的<strong>第一条</strong>记录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [carltest]&gt; SELECT department, COUNT(<span class="built_in">id</span>) as sum_of_department FROM student GROUP BY department;</span><br><span class="line">+--------------+-------------------+</span><br><span class="line">| department   | sum_of_department |</span><br><span class="line">+--------------+-------------------+</span><br><span class="line">| 中文系       |                 2 |</span><br><span class="line">| 英语系       |                 2 |</span><br><span class="line">| 计算机系     |                 2 |</span><br><span class="line">+--------------+-------------------+</span><br><span class="line">3 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 首先按照c_name字段对score表中的记录进行分组. 然后使用MAX()函数计算每组的最大值</span></span><br><span class="line">MariaDB [carltest]&gt; SELECT c_name, MAX(grade) FROM score GROUP BY c_name;</span><br><span class="line">+-----------+------------+</span><br><span class="line">| c_name    | MAX(grade) |</span><br><span class="line">+-----------+------------+</span><br><span class="line">| 中文      |         95 |</span><br><span class="line">| 英语      |         94 |</span><br><span class="line">| 计算机    |         98 |</span><br><span class="line">+-----------+------------+</span><br><span class="line">3 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.01 sec)</span><br></pre></td></tr></table></figure>

<p>GROUP BY 后面多个属性的时候, 先按照属性1分组, 如果属性1相同, 再按照属性2分组</p>
<h5 id="嵌套查询"><a href="#嵌套查询" class="headerlink" title="嵌套查询"></a>嵌套查询</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [carltest]&gt; SELECT c_name, grade FROM score WHERE stu_id=(SELECT <span class="built_in">id</span> FROM student WHERE name=<span class="string">&#x27;李四&#x27;</span>);</span><br><span class="line">+-----------+-------+</span><br><span class="line">| c_name    | grade |</span><br><span class="line">+-----------+-------+</span><br><span class="line">| 计算机    |    70 |</span><br><span class="line">| 英语      |    92 |</span><br><span class="line">+-----------+-------+</span><br><span class="line">2 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.03 sec)</span><br></pre></td></tr></table></figure>


<h5 id="UNION-UNION-ALL用法"><a href="#UNION-UNION-ALL用法" class="headerlink" title="UNION, UNION ALL用法"></a>UNION, UNION ALL用法</h5><p>使用UNION关键字时, 数据库系统会将所有的查询结果合并到一起, <strong>然后去掉相同的记录</strong>. 而UNION ALL关键字则只是简单的合并到一起.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [carltest]&gt; SELECT <span class="built_in">id</span> FROM student UNION SELECT stu_id FROM score;</span><br><span class="line">+-----+</span><br><span class="line">| <span class="built_in">id</span>  |</span><br><span class="line">+-----+</span><br><span class="line">| 901 |</span><br><span class="line">| 902 |</span><br><span class="line">| 903 |</span><br><span class="line">| 904 |</span><br><span class="line">| 905 |</span><br><span class="line">| 906 |</span><br><span class="line">+-----+</span><br><span class="line">6 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [carltest]&gt; SELECT <span class="built_in">id</span> FROM student UNION ALL SELECT stu_id FROM score;</span><br><span class="line">+-----+</span><br><span class="line">| <span class="built_in">id</span>  |</span><br><span class="line">+-----+</span><br><span class="line">| 901 |</span><br><span class="line">| 902 |</span><br><span class="line">| 903 |</span><br><span class="line">| 904 |</span><br><span class="line">| 905 |</span><br><span class="line">| 906 |</span><br><span class="line">| 901 |</span><br><span class="line">| 901 |</span><br><span class="line">| 902 |</span><br><span class="line">| 902 |</span><br><span class="line">| 903 |</span><br><span class="line">| 904 |</span><br><span class="line">| 904 |</span><br><span class="line">| 905 |</span><br><span class="line">| 906 |</span><br><span class="line">| 906 |</span><br><span class="line">+-----+</span><br><span class="line">16 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="ANY关键字"><a href="#ANY关键字" class="headerlink" title="ANY关键字"></a>ANY关键字</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [carltest]&gt; SELECT * FROM student WHERE <span class="built_in">id</span>=ANY (SELECT stu_id FROM score WHERE stu_id <span class="keyword">in</span> (SELECT stu_id FROM score WHERE c_name=<span class="string">&#x27;计算机&#x27;</span>) AND c_name=<span class="string">&#x27;英语&#x27;</span>);</span><br><span class="line">+-----+-----------+------+-------+--------------+--------------------+</span><br><span class="line">| <span class="built_in">id</span>  | name      | sex  | birth | department   | address            |</span><br><span class="line">+-----+-----------+------+-------+--------------+--------------------+</span><br><span class="line">| 901 | 张老大    | 男   |  1985 | 计算机系     | 北京市海淀区       |</span><br><span class="line">| 904 | 李四      | 男   |  1990 | 英语系       | 辽宁省阜新市       |</span><br><span class="line">| 906 | 王六      | 男   |  1988 | 计算机系     | 湖南省衡阳市       |</span><br><span class="line">+-----+-----------+------+-------+--------------+--------------------+</span><br><span class="line">3 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.04 sec)</span><br></pre></td></tr></table></figure>

<h5 id="正则表达式匹配查询"><a href="#正则表达式匹配查询" class="headerlink" title="正则表达式匹配查询"></a>正则表达式匹配查询</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">SELECT * FROM table_name <span class="built_in">where</span> xx REGEXP <span class="string">&#x27;匹配方式&#x27;</span>;</span><br><span class="line"></span><br><span class="line">模式字符      含义</span><br><span class="line"></span><br><span class="line">^             匹配字符串开始的部分</span><br><span class="line">$             匹配字符串结束的部分</span><br><span class="line">.             代表字符串中的任意一个字符, 包括回车和换行</span><br><span class="line">[字符集合]    匹配<span class="string">&quot;字符集合&quot;</span>中的任何一个字符</span><br><span class="line">[^字符集合]   匹配除了<span class="string">&quot;字符集合&quot;</span>以外的任何一个字符</span><br><span class="line">S1|S2|S3      匹配S1, S2和S3中的任意一个字符串</span><br><span class="line">*             代表多个该符号之前的字符, 包括0和1个</span><br><span class="line">+             代表多个该符号之前的字符, 包括1个</span><br><span class="line">字符串&#123;N&#125;     字符串出现N次</span><br><span class="line">字符串&#123;M,N&#125;   字符串出现至少M次, 最多N次</span><br><span class="line"></span><br><span class="line">MariaDB [carltest]&gt; SELECT student.id name, sex, birth, department address, c_name, grade FROM student, score WHERE (name LIKE <span class="string">&#x27;张%&#x27;</span> OR name LIKE <span class="string">&#x27;王%&#x27;</span>) AND student.id=score.stu_id;</span><br><span class="line">+------+------+-------+--------------+-----------+-------+</span><br><span class="line">| name | sex  | birth | address      | c_name    | grade |</span><br><span class="line">+------+------+-------+--------------+-----------+-------+</span><br><span class="line">|  901 | 男   |  1985 | 计算机系     | 计算机    |    98 |</span><br><span class="line">|  901 | 男   |  1985 | 计算机系     | 英语      |    80 |</span><br><span class="line">|  902 | 男   |  1986 | 中文系       | 计算机    |    65 |</span><br><span class="line">|  902 | 男   |  1986 | 中文系       | 中文      |    88 |</span><br><span class="line">|  903 | 女   |  1990 | 中文系       | 中文      |    95 |</span><br><span class="line">|  905 | 女   |  1991 | 英语系       | 英语      |    94 |</span><br><span class="line">|  906 | 男   |  1988 | 计算机系     | 计算机    |    90 |</span><br><span class="line">|  906 | 男   |  1988 | 计算机系     | 英语      |    85 |</span><br><span class="line">+------+------+-------+--------------+-----------+-------+</span><br><span class="line">8 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br></pre></td></tr></table></figure>

<h5 id="连接查询"><a href="#连接查询" class="headerlink" title="连接查询"></a>连接查询</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># 先从student表中删除id为902和903两行, 方便下面区分</span></span><br><span class="line">MariaDB [carltest]&gt; <span class="keyword">select</span> * from student;</span><br><span class="line">+-----+-----------+------+-------+--------------+--------------------+</span><br><span class="line">| <span class="built_in">id</span>  | name      | sex  | birth | department   | address            |</span><br><span class="line">+-----+-----------+------+-------+--------------+--------------------+</span><br><span class="line">| 901 | 张老大    | 男   |  1985 | 计算机系     | 北京市海淀区       |</span><br><span class="line">| 904 | 李四      | 男   |  1990 | 英语系       | 辽宁省阜新市       |</span><br><span class="line">| 905 | 王五      | 女   |  1991 | 英语系       | 福建省厦门市       |</span><br><span class="line">| 906 | 王六      | 男   |  1988 | 计算机系     | 湖南省衡阳市       |</span><br><span class="line">+-----+-----------+------+-------+--------------+--------------------+</span><br><span class="line">4 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [carltest]&gt; <span class="keyword">select</span> * from score;</span><br><span class="line">+----+--------+-----------+-------+</span><br><span class="line">| <span class="built_in">id</span> | stu_id | c_name    | grade |</span><br><span class="line">+----+--------+-----------+-------+</span><br><span class="line">|  1 |    901 | 计算机    |    98 |</span><br><span class="line">|  2 |    901 | 英语      |    80 |</span><br><span class="line">|  3 |    902 | 计算机    |    65 |</span><br><span class="line">|  4 |    902 | 中文      |    88 |</span><br><span class="line">|  5 |    903 | 中文      |    95 |</span><br><span class="line">|  6 |    904 | 计算机    |    70 |</span><br><span class="line">|  7 |    904 | 英语      |    92 |</span><br><span class="line">|  8 |    905 | 英语      |    94 |</span><br><span class="line">|  9 |    906 | 计算机    |    90 |</span><br><span class="line">| 10 |    906 | 英语      |    85 |</span><br><span class="line">+----+--------+-----------+-------+</span><br><span class="line">10 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 内连接查询</span></span><br><span class="line">MariaDB [carltest]&gt; SELECT student.id name, sex, birth, department, address, c_name grade FROM student, score WHERE student.id=score.stu_id;</span><br><span class="line">+------+------+-------+--------------+--------------------+-----------+</span><br><span class="line">| name | sex  | birth | department   | address            | grade     |</span><br><span class="line">+------+------+-------+--------------+--------------------+-----------+</span><br><span class="line">|  901 | 男   |  1985 | 计算机系     | 北京市海淀区       | 计算机    |</span><br><span class="line">|  901 | 男   |  1985 | 计算机系     | 北京市海淀区       | 英语      |</span><br><span class="line">|  904 | 男   |  1990 | 英语系       | 辽宁省阜新市       | 计算机    |</span><br><span class="line">|  904 | 男   |  1990 | 英语系       | 辽宁省阜新市       | 英语      |</span><br><span class="line">|  905 | 女   |  1991 | 英语系       | 福建省厦门市       | 英语      |</span><br><span class="line">|  906 | 男   |  1988 | 计算机系     | 湖南省衡阳市       | 计算机    |</span><br><span class="line">|  906 | 男   |  1988 | 计算机系     | 湖南省衡阳市       | 英语      |</span><br><span class="line">+------+------+-------+--------------+--------------------+-----------+</span><br><span class="line">7 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 给student和score起个别名</span></span><br><span class="line">MariaDB [carltest]&gt; SELECT s1.id name, sex, birth, department, address, c_name grade FROM student s1, score s2 WHERE s1.id=s2.stu_id;</span><br><span class="line">+------+------+-------+--------------+--------------------+-----------+</span><br><span class="line">| name | sex  | birth | department   | address            | grade     |</span><br><span class="line">+------+------+-------+--------------+--------------------+-----------+</span><br><span class="line">|  901 | 男   |  1985 | 计算机系     | 北京市海淀区       | 计算机    |</span><br><span class="line">|  901 | 男   |  1985 | 计算机系     | 北京市海淀区       | 英语      |</span><br><span class="line">|  904 | 男   |  1990 | 英语系       | 辽宁省阜新市       | 计算机    |</span><br><span class="line">|  904 | 男   |  1990 | 英语系       | 辽宁省阜新市       | 英语      |</span><br><span class="line">|  905 | 女   |  1991 | 英语系       | 福建省厦门市       | 英语      |</span><br><span class="line">|  906 | 男   |  1988 | 计算机系     | 湖南省衡阳市       | 计算机    |</span><br><span class="line">|  906 | 男   |  1988 | 计算机系     | 湖南省衡阳市       | 英语      |</span><br><span class="line">+------+------+-------+--------------+--------------------+-----------+</span><br><span class="line">7 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 外连接查询</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># LEFT JOIN, 返回student所有的数据</span></span><br><span class="line">MariaDB [carltest]&gt; SELECT student.id, c_name FROM student LEFT JOIN  score on student.id=score.stu_id;</span><br><span class="line">+-----+-----------+</span><br><span class="line">| <span class="built_in">id</span>  | c_name    |</span><br><span class="line">+-----+-----------+</span><br><span class="line">| 901 | 计算机    |</span><br><span class="line">| 901 | 英语      |</span><br><span class="line">| 904 | 计算机    |</span><br><span class="line">| 904 | 英语      |</span><br><span class="line">| 905 | 英语      |</span><br><span class="line">| 906 | 计算机    |</span><br><span class="line">| 906 | 英语      |</span><br><span class="line">+-----+-----------+</span><br><span class="line">7 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line"><span class="comment"># RIGHT JOIN, 返回score所有的数据</span></span><br><span class="line">MariaDB [carltest]&gt; SELECT student.id, c_name FROM student RIGHT JOIN  score on student.id=score.stu_id;</span><br><span class="line">+------+-----------+</span><br><span class="line">| <span class="built_in">id</span>   | c_name    |</span><br><span class="line">+------+-----------+</span><br><span class="line">|  901 | 计算机    |</span><br><span class="line">|  901 | 英语      |</span><br><span class="line">| NULL | 计算机    |</span><br><span class="line">| NULL | 中文      |</span><br><span class="line">| NULL | 中文      |</span><br><span class="line">|  904 | 计算机    |</span><br><span class="line">|  904 | 英语      |</span><br><span class="line">|  905 | 英语      |</span><br><span class="line">|  906 | 计算机    |</span><br><span class="line">|  906 | 英语      |</span><br><span class="line">+------+-----------+</span><br><span class="line">10 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br></pre></td></tr></table></figure>

<h2 id="插入-更新-删除数据"><a href="#插入-更新-删除数据" class="headerlink" title="插入, 更新, 删除数据"></a>插入, 更新, 删除数据</h2><h5 id="先建一张表-接下来用来操作"><a href="#先建一张表-接下来用来操作" class="headerlink" title="先建一张表, 接下来用来操作"></a>先建一张表, 接下来用来操作</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [carltest]&gt; CREATE TABLE food (<span class="built_in">id</span> INT(10) NOT NULL UNIQUE PRIMARY KEY AUTO_INCREMENT,</span><br><span class="line">    -&gt;                    name VARCHAR(20) NOT NULL,</span><br><span class="line">    -&gt;                    company VARCHAR(30) NOT NULL,</span><br><span class="line">    -&gt;                    price FLOAT,</span><br><span class="line">    -&gt;                    produce_time YEAR,</span><br><span class="line">    -&gt;                    validity_time INT(4),</span><br><span class="line">    -&gt;                    address VARCHAR(50));</span><br><span class="line">Query OK, 0 rows affected (0.31 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [carltest]&gt; desc food;</span><br><span class="line">+---------------+-------------+------+-----+---------+----------------+</span><br><span class="line">| Field         | Type        | Null | Key | Default | Extra          |</span><br><span class="line">+---------------+-------------+------+-----+---------+----------------+</span><br><span class="line">| <span class="built_in">id</span>            | int(10)     | NO   | PRI | NULL    | auto_increment |</span><br><span class="line">| name          | varchar(20) | NO   |     | NULL    |                |</span><br><span class="line">| company       | varchar(30) | NO   |     | NULL    |                |</span><br><span class="line">| price         | <span class="built_in">float</span>       | YES  |     | NULL    |                |</span><br><span class="line">| produce_time  | year(4)     | YES  |     | NULL    |                |</span><br><span class="line">| validity_time | int(4)      | YES  |     | NULL    |                |</span><br><span class="line">| address       | varchar(50) | YES  |     | NULL    |                |</span><br><span class="line">+---------------+-------------+------+-----+---------+----------------+</span><br><span class="line">7 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.09 sec)</span><br></pre></td></tr></table></figure>

<h3 id="插入数据"><a href="#插入数据" class="headerlink" title="插入数据"></a>插入数据</h3><h5 id="INSERT语句中不指定具体的字段名"><a href="#INSERT语句中不指定具体的字段名" class="headerlink" title="INSERT语句中不指定具体的字段名"></a>INSERT语句中不指定具体的字段名</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># INSERT INTO tbl VALUES (值1, 值2, ..., 值n)</span></span><br><span class="line"></span><br><span class="line">MariaDB [carltest]&gt; INSERT INTO food VALUES (1, <span class="string">&#x27;AA饼干&#x27;</span>, <span class="string">&#x27;AA饼干厂&#x27;</span>, 2.5, <span class="string">&#x27;2008&#x27;</span>, 3, <span class="string">&#x27;北京&#x27;</span>);</span><br><span class="line">Query OK, 1 row affected (0.05 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [carltest]&gt; <span class="keyword">select</span> * from food;</span><br><span class="line">+----+----------+-------------+-------+--------------+---------------+---------+</span><br><span class="line">| <span class="built_in">id</span> | name     | company     | price | produce_time | validity_time | address |</span><br><span class="line">+----+----------+-------------+-------+--------------+---------------+---------+</span><br><span class="line">|  1 | AA饼干   | AA饼干厂    |   2.5 |         2008 |             3 | 北京    |</span><br><span class="line">+----+----------+-------------+-------+--------------+---------------+---------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br></pre></td></tr></table></figure>

<h5 id="插入指定列"><a href="#插入指定列" class="headerlink" title="插入指定列"></a>插入指定列</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># INSERT INTO tbl (属性1, 属性2, ..., 属性m)</span></span><br><span class="line"><span class="comment">#         VALUES (值1, 值2, ..., 值m)</span></span><br><span class="line"></span><br><span class="line">MariaDB [carltest]&gt; INSERT INTO food (<span class="built_in">id</span>, name, company, price, produce_time, validity_time, address) VALUES (2, <span class="string">&#x27;CC牛奶&#x27;</span>, <span class="string">&#x27;CC牛奶厂&#x27;</span>, 3.5, <span class="string">&#x27;2009&#x27;</span>, 1, <span class="string">&#x27;河北&#x27;</span>);</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [carltest]&gt; <span class="keyword">select</span> * from food;</span><br><span class="line">+----+----------+-------------+-------+--------------+---------------+---------+</span><br><span class="line">| <span class="built_in">id</span> | name     | company     | price | produce_time | validity_time | address |</span><br><span class="line">+----+----------+-------------+-------+--------------+---------------+---------+</span><br><span class="line">|  1 | AA饼干   | AA饼干厂    |   2.5 |         2008 |             3 | 北京    |</span><br><span class="line">|  2 | CC牛奶   | CC牛奶厂    |   3.5 |         2009 |             1 | 河北    |</span><br><span class="line">+----+----------+-------------+-------+--------------+---------------+---------+</span><br><span class="line">2 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br></pre></td></tr></table></figure>

<h5 id="同时插入多行数据"><a href="#同时插入多行数据" class="headerlink" title="同时插入多行数据"></a>同时插入多行数据</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># INSERT INTO tbl [(属性列表)]</span></span><br><span class="line"><span class="comment">#         VALUES (取值列表1), (取值列表2), ..., (取值列表n);</span></span><br><span class="line"></span><br><span class="line">INSERT INTO food VALUES (NULL, <span class="string">&#x27;EE果冻&#x27;</span>, <span class="string">&#x27;EE果冻厂&#x27;</span>, 1.5, <span class="string">&#x27;2007&#x27;</span>, 2, <span class="string">&#x27;北京&#x27;</span>),</span><br><span class="line">                        (NULL, <span class="string">&#x27;FF咖啡&#x27;</span>, <span class="string">&#x27;FF咖啡厂&#x27;</span>, 20, <span class="string">&#x27;2002&#x27;</span>, 5, <span class="string">&#x27;天津&#x27;</span>),</span><br><span class="line">                        (NULL, <span class="string">&#x27;GG奶糖&#x27;</span>, <span class="string">&#x27;GG奶糖厂&#x27;</span>, 14, <span class="string">&#x27;2003&#x27;</span>, 3, <span class="string">&#x27;广东&#x27;</span>);</span><br><span class="line"></span><br><span class="line">MariaDB [carltest]&gt; INSERT INTO food VALUES (NULL, <span class="string">&#x27;EE果冻&#x27;</span>, <span class="string">&#x27;EE果冻厂&#x27;</span>, 1.5, <span class="string">&#x27;2007&#x27;</span>, 2, <span class="string">&#x27;北京&#x27;</span>),</span><br><span class="line">    -&gt;                         (NULL, <span class="string">&#x27;FF咖啡&#x27;</span>, <span class="string">&#x27;FF咖啡厂&#x27;</span>, 20, <span class="string">&#x27;2002&#x27;</span>, 5, <span class="string">&#x27;天津&#x27;</span>),</span><br><span class="line">    -&gt;                         (NULL, <span class="string">&#x27;GG奶糖&#x27;</span>, <span class="string">&#x27;GG奶糖厂&#x27;</span>, 14, <span class="string">&#x27;2003&#x27;</span>, 3, <span class="string">&#x27;广东&#x27;</span>);</span><br><span class="line">Query OK, 3 rows affected (0.01 sec)</span><br><span class="line">Records: 3  Duplicates: 0  Warnings: 0</span><br><span class="line"></span><br><span class="line">MariaDB [carltest]&gt; <span class="keyword">select</span> * from food;</span><br><span class="line">+----+----------+-------------+-------+--------------+---------------+---------+</span><br><span class="line">| <span class="built_in">id</span> | name     | company     | price | produce_time | validity_time | address |</span><br><span class="line">+----+----------+-------------+-------+--------------+---------------+---------+</span><br><span class="line">|  1 | AA饼干   | AA饼干厂    |   2.5 |         2008 |             3 | 北京    |</span><br><span class="line">|  2 | CC牛奶   | CC牛奶厂    |   3.5 |         2009 |             1 | 河北    |</span><br><span class="line">|  3 | EE果冻   | EE果冻厂    |   1.5 |         2007 |             2 | 北京    |</span><br><span class="line">|  4 | FF咖啡   | FF咖啡厂    |    20 |         2002 |             5 | 天津    |</span><br><span class="line">|  5 | GG奶糖   | GG奶糖厂    |    14 |         2003 |             3 | 广东    |</span><br><span class="line">+----+----------+-------------+-------+--------------+---------------+---------+</span><br><span class="line">5 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br></pre></td></tr></table></figure>

<h5 id="将查询结果插入到表中"><a href="#将查询结果插入到表中" class="headerlink" title="将查询结果插入到表中"></a>将查询结果插入到表中</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># INSERT INTO tbl1 (属性列表1)</span></span><br><span class="line"><span class="comment">#        SELECT 属性列表2 FROM tbl2 WHERE 条件表达式;</span></span><br><span class="line"></span><br><span class="line">MariaDB [carltest]&gt; desc food1;</span><br><span class="line">+---------------+-------------+------+-----+---------+----------------+</span><br><span class="line">| Field         | Type        | Null | Key | Default | Extra          |</span><br><span class="line">+---------------+-------------+------+-----+---------+----------------+</span><br><span class="line">| <span class="built_in">id</span>            | int(10)     | NO   | PRI | NULL    | auto_increment |</span><br><span class="line">| name          | varchar(20) | NO   |     | NULL    |                |</span><br><span class="line">| company       | varchar(30) | NO   |     | NULL    |                |</span><br><span class="line">| price         | <span class="built_in">float</span>       | YES  |     | NULL    |                |</span><br><span class="line">| produce_time  | year(4)     | YES  |     | NULL    |                |</span><br><span class="line">| validity_time | int(4)      | YES  |     | NULL    |                |</span><br><span class="line">| address       | varchar(50) | YES  |     | NULL    |                |</span><br><span class="line">+---------------+-------------+------+-----+---------+----------------+</span><br><span class="line">7 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.12 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [carltest]&gt; INSERT INTO food1 SELECT * FROM  food;</span><br><span class="line">Query OK, 5 rows affected (0.01 sec)</span><br><span class="line">Records: 5  Duplicates: 0  Warnings: 0</span><br><span class="line"></span><br><span class="line">MariaDB [carltest]&gt; <span class="keyword">select</span> * from food1;</span><br><span class="line">+----+----------+-------------+-------+--------------+---------------+---------+</span><br><span class="line">| <span class="built_in">id</span> | name     | company     | price | produce_time | validity_time | address |</span><br><span class="line">+----+----------+-------------+-------+--------------+---------------+---------+</span><br><span class="line">|  1 | AA饼干   | AA饼干厂    |   2.5 |         2008 |             3 | 北京    |</span><br><span class="line">|  2 | CC牛奶   | CC牛奶厂    |   3.5 |         2009 |             1 | 河北    |</span><br><span class="line">|  3 | EE果冻   | EE果冻厂    |   1.5 |         2007 |             2 | 北京    |</span><br><span class="line">|  4 | FF咖啡   | FF咖啡厂    |    20 |         2002 |             5 | 天津    |</span><br><span class="line">|  5 | GG奶糖   | GG奶糖厂    |    14 |         2003 |             3 | 广东    |</span><br><span class="line">+----+----------+-------------+-------+--------------+---------------+---------+</span><br><span class="line">5 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br></pre></td></tr></table></figure>

<h3 id="更新数据"><a href="#更新数据" class="headerlink" title="更新数据"></a>更新数据</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># UPDATE tbl SET 属性1=值1, 属性2=值2, ..., 属性n=值n WHERE 条件表达式</span></span><br><span class="line"></span><br><span class="line">MariaDB [carltest]&gt; <span class="keyword">select</span> * from food <span class="built_in">where</span> name=<span class="string">&#x27;CC牛奶&#x27;</span>;</span><br><span class="line">+----+----------+-------------+-------+--------------+---------------+---------+</span><br><span class="line">| <span class="built_in">id</span> | name     | company     | price | produce_time | validity_time | address |</span><br><span class="line">+----+----------+-------------+-------+--------------+---------------+---------+</span><br><span class="line">|  2 | CC牛奶   | CC牛奶厂    |   3.5 |         2009 |             1 | 河北    |</span><br><span class="line">+----+----------+-------------+-------+--------------+---------------+---------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [carltest]&gt; update food <span class="built_in">set</span> address=<span class="string">&#x27;内蒙古&#x27;</span>, price=3.2 <span class="built_in">where</span> name=<span class="string">&#x27;CC牛奶&#x27;</span>;</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line">Rows matched: 1  Changed: 1  Warnings: 0</span><br><span class="line"></span><br><span class="line">MariaDB [carltest]&gt; <span class="keyword">select</span> * from food <span class="built_in">where</span> name=<span class="string">&#x27;CC牛奶&#x27;</span>;</span><br><span class="line">+----+----------+-------------+-------+--------------+---------------+-----------+</span><br><span class="line">| <span class="built_in">id</span> | name     | company     | price | produce_time | validity_time | address   |</span><br><span class="line">+----+----------+-------------+-------+--------------+---------------+-----------+</span><br><span class="line">|  2 | CC牛奶   | CC牛奶厂    |   3.2 |         2009 |             1 | 内蒙古    |</span><br><span class="line">+----+----------+-------------+-------+--------------+---------------+-----------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br></pre></td></tr></table></figure>

<h3 id="删除数据"><a href="#删除数据" class="headerlink" title="删除数据"></a>删除数据</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># DELETE FROM tbl [WHERE 条件表达式]</span></span><br><span class="line"></span><br><span class="line">MariaDB [carltest]&gt; <span class="keyword">select</span> * from food <span class="built_in">where</span> address=<span class="string">&#x27;北京&#x27;</span>;</span><br><span class="line">+----+----------+-------------+-------+--------------+---------------+---------+</span><br><span class="line">| <span class="built_in">id</span> | name     | company     | price | produce_time | validity_time | address |</span><br><span class="line">+----+----------+-------------+-------+--------------+---------------+---------+</span><br><span class="line">|  1 | AA饼干   | AA饼干厂    |   2.5 |         2008 |             3 | 北京    |</span><br><span class="line">|  3 | EE果冻   | EE果冻厂    |   1.5 |         2007 |             2 | 北京    |</span><br><span class="line">+----+----------+-------------+-------+--------------+---------------+---------+</span><br><span class="line">2 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [carltest]&gt; delete from food <span class="built_in">where</span> address=<span class="string">&#x27;北京&#x27;</span>;</span><br><span class="line">Query OK, 2 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [carltest]&gt; <span class="keyword">select</span> * from food <span class="built_in">where</span> address=<span class="string">&#x27;北京&#x27;</span>;</span><br><span class="line">Empty <span class="built_in">set</span> (0.00 sec)</span><br></pre></td></tr></table></figure>

<h2 id="表结构修改"><a href="#表结构修改" class="headerlink" title="表结构修改"></a>表结构修改</h2><h3 id="修改表名"><a href="#修改表名" class="headerlink" title="修改表名"></a>修改表名</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table t_book rename to bbb;</span><br></pre></td></tr></table></figure>

<h3 id="添加列"><a href="#添加列" class="headerlink" title="添加列"></a>添加列</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名 add column 列名 varchar(30);</span><br></pre></td></tr></table></figure>

<h3 id="修改列"><a href="#修改列" class="headerlink" title="修改列"></a>修改列</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名 modify column 字段名 新数据类型 新类型长度 新默认值 新注释;</span><br><span class="line"></span><br><span class="line">alter table 表名 change 旧字段名 新字段名 新数据类型;</span><br></pre></td></tr></table></figure>

<h3 id="删除列"><a href="#删除列" class="headerlink" title="删除列"></a>删除列</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名 drop column 列名;</span><br></pre></td></tr></table></figure>

<h3 id="修改unique-key"><a href="#修改unique-key" class="headerlink" title="修改unique key"></a>修改unique key</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">alter table table_name drop index `uk_name`;</span><br><span class="line">alter table table_name add unique key `new_uk_name` (`col1`,`col2`);</span><br></pre></td></tr></table></figure>

<h2 id="权限管理"><a href="#权限管理" class="headerlink" title="权限管理"></a>权限管理</h2><p>MySQL中权限分配是按照user表, db表, tables_priv表和columns_priv表的顺序进行分配的. 数据库系统中, 先判断user表中的值为Y.<br>如果user表中的值为Y, 就不需要检查后面的表. 如果user表的为N, 则依次检查db表, tables_priv表和columns_priv表</p>
<h3 id="mysql-user表"><a href="#mysql-user表" class="headerlink" title="mysql.user表"></a>mysql.user表</h3><h5 id="权限列中有很多权限字段需要特别注意"><a href="#权限列中有很多权限字段需要特别注意" class="headerlink" title="权限列中有很多权限字段需要特别注意:"></a>权限列中有很多权限字段需要特别注意:</h5><table>
<thead>
<tr>
<th>字段名</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>Grant_priv</td>
<td>表示是否拥有GRANT权限</td>
</tr>
<tr>
<td>Shutdown_priv</td>
<td>表示是否拥有停止MySQL的权限</td>
</tr>
<tr>
<td>Super_priv</td>
<td>表示是否拥有超级权限</td>
</tr>
<tr>
<td>Execute_priv</td>
<td>表示是否有EXECUTE权限, 该权限可以执行存储过程和函数</td>
</tr>
</tbody></table>
<h5 id="user表的资源控制列"><a href="#user表的资源控制列" class="headerlink" title="user表的资源控制列"></a>user表的资源控制列</h5><table>
<thead>
<tr>
<th>字段名</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>max_questions</td>
<td>每小时可以允许执行多少次查询</td>
</tr>
<tr>
<td>max_updates</td>
<td>每小时可以允许执行多少次更新</td>
</tr>
<tr>
<td>max_connections</td>
<td>每小时可以建立多少连接</td>
</tr>
<tr>
<td>max_user_connections</td>
<td>每个用户可以同时具有的连接数.</td>
</tr>
</tbody></table>
<p>以上每个字段默认值为0, 表示没有限制</p>
<h3 id="用户账号相关"><a href="#用户账号相关" class="headerlink" title="用户账号相关"></a>用户账号相关</h3><h5 id="新建普通用户"><a href="#新建普通用户" class="headerlink" title="新建普通用户"></a>新建普通用户</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># CREATE USER user [IDENTIFIED BY [PASSWORD] &#x27;passwd&#x27;] [, user [IDENTIFIED BY [PASSWORD] &#x27;passwd&#x27;]] ...</span></span><br><span class="line"><span class="comment"># GRANT priv_type ON databse.table TO user [IDENTIFIED BY [PASSWORD] &#x27;passwd&#x27;] [, user [IDENTIFIED BY [PASSWORD] &#x27;passwd&#x27;]] ...</span></span><br><span class="line"></span><br><span class="line">MariaDB [mysql]&gt; create user <span class="string">&#x27;test1&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> identified by <span class="string">&#x27;test1_password&#x27;</span>;</span><br><span class="line">Query OK, 0 rows affected (0.27 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [mysql]&gt; GRANT SELECT ON carltest.* TO <span class="string">&#x27;test3&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> IDENTIFIED BY <span class="string">&#x27;test3&#x27;</span>;</span><br><span class="line">Query OK, 0 rows affected (0.05 sec)</span><br></pre></td></tr></table></figure>

<h5 id="删除普通用户"><a href="#删除普通用户" class="headerlink" title="删除普通用户"></a>删除普通用户</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># DROP USER user [, user] ...</span></span><br><span class="line"><span class="comment"># DELETE FROM mysql.user WHERE Host=&#x27;localhost&#x27; AND User=&#x27;username&#x27;;</span></span><br><span class="line"></span><br><span class="line">MariaDB [mysql]&gt; DROP USER <span class="string">&#x27;test1&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [mysql]&gt; DELETE FROM mysql.user WHERE Host=<span class="string">&#x27;localhost&#x27;</span> AND User=<span class="string">&#x27;test3&#x27;</span>;</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [mysql]&gt; FLUSH PRIVILEGES;</span><br><span class="line">Query OK, 0 rows affected (0.11 sec)</span><br></pre></td></tr></table></figure>

<h5 id="root用户修改root用户的密码"><a href="#root用户修改root用户的密码" class="headerlink" title="root用户修改root用户的密码"></a>root用户修改root用户的密码</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># mysqladmin -u $username -p password &quot;new_password&quot;;</span></span><br><span class="line"><span class="comment"># update mysql.user set Password=PASSWORD(&#x27;new_password&#x27;) where User=&#x27;root&#x27; and Host=&#x27;localhost&#x27;;</span></span><br><span class="line"><span class="comment"># SET PASSWORD=PASSWORD(&#x27;new_password&#x27;);</span></span><br></pre></td></tr></table></figure>

<h5 id="root用户修改普通用户密码"><a href="#root用户修改普通用户密码" class="headerlink" title="root用户修改普通用户密码"></a>root用户修改普通用户密码</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># SET PASSWORD FOR &#x27;username&#x27;@&#x27;hostname&#x27;=PASSWORD(&#x27;new_password&#x27;);</span></span><br><span class="line"><span class="comment"># UPDATE mysql.user SET Password=PASSWORD(&#x27;mytest2&#x27;) WHERE User=&#x27;test3&#x27; AND Host=&#x27;localhost&#x27;;</span></span><br><span class="line"><span class="comment"># GRANT priv_type ON database.table TO user [IDENTIFIED BY [PASSWORD] &#x27;password&#x27;];</span></span><br><span class="line">&gt; GRANT SELECT ON *.* TO <span class="string">&#x27;test3&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> IDENTIFIED BY <span class="string">&#x27;mytest3&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h5 id="普通用户修改密码"><a href="#普通用户修改密码" class="headerlink" title="普通用户修改密码"></a>普通用户修改密码</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># SET PASSWORD=PASSWORD(&#x27;new_password&#x27;);</span></span><br></pre></td></tr></table></figure>

<h3 id="MySQL的各种权限"><a href="#MySQL的各种权限" class="headerlink" title="MySQL的各种权限"></a>MySQL的各种权限</h3><table>
<thead>
<tr>
<th>权限名称</th>
<th>对应user表中的列</th>
<th>权限的范围</th>
</tr>
</thead>
<tbody><tr>
<td>CREATE</td>
<td>Create_priv</td>
<td>数据库, 表或索引</td>
</tr>
<tr>
<td>DROP</td>
<td>Drop_priv</td>
<td>数据库, 表</td>
</tr>
<tr>
<td>GRANT OPTION</td>
<td>Grant_priv</td>
<td>数据库, 表, 存储过程, 函数</td>
</tr>
<tr>
<td>REFERENCES</td>
<td>References_priv</td>
<td>数据库, 表</td>
</tr>
<tr>
<td>ALTER</td>
<td>Alter_priv</td>
<td>修改表</td>
</tr>
<tr>
<td>DELETE</td>
<td>Delete_priv</td>
<td>删除表</td>
</tr>
<tr>
<td>INDEX</td>
<td>Index_priv</td>
<td>用索引查询表</td>
</tr>
<tr>
<td>INSERT</td>
<td>Insert_priv</td>
<td>插入表</td>
</tr>
<tr>
<td>SELECT</td>
<td>Select_priv</td>
<td>查询表</td>
</tr>
<tr>
<td>UPDATE</td>
<td>Update_priv</td>
<td>更新表</td>
</tr>
<tr>
<td>CREATE VIEW</td>
<td>Create_view_priv</td>
<td>创建视图</td>
</tr>
<tr>
<td>SHOW VIEW</td>
<td>Show_view_priv</td>
<td>查看视图</td>
</tr>
<tr>
<td>ALTER ROUTINE</td>
<td>Alter_routine_priv</td>
<td>修改存储过程或存储函数</td>
</tr>
<tr>
<td>CREATE ROUTINE</td>
<td>Create_routine_priv</td>
<td>创建存储过程或存储函数</td>
</tr>
<tr>
<td>EXECUTE</td>
<td>Execute_priv</td>
<td>执行存储过程或存储函数</td>
</tr>
<tr>
<td>FILE</td>
<td>File_priv</td>
<td>加载服务器主机上的文件</td>
</tr>
<tr>
<td>CREATE TEMPORARY TABLES</td>
<td>Create_tmp_table_priv</td>
<td>创建临时表</td>
</tr>
<tr>
<td>LOCK TABLES</td>
<td>Lock_tables_priv</td>
<td>锁定表</td>
</tr>
<tr>
<td>CREATE USER</td>
<td>Create_user_priv</td>
<td>创建用户</td>
</tr>
<tr>
<td>PROCESS</td>
<td>Process_priv</td>
<td>服务器管理</td>
</tr>
<tr>
<td>RELOAD</td>
<td>Reload_priv</td>
<td>重新加载权限表</td>
</tr>
<tr>
<td>REPLICATION CLIENT</td>
<td>Repl_client_priv</td>
<td>服务器管理</td>
</tr>
<tr>
<td>REPLICATION SLAVE</td>
<td>Repl_slave_priv</td>
<td>服务器管理</td>
</tr>
<tr>
<td>SHOW DATABASES</td>
<td>Show_db_priv</td>
<td>查看数据库</td>
</tr>
<tr>
<td>SHUTDOWN</td>
<td>Shutdown_priv</td>
<td>关闭服务器</td>
</tr>
<tr>
<td>SUPER</td>
<td>Super_priv</td>
<td>超级权限</td>
</tr>
</tbody></table>
<h3 id="授权与收回权限"><a href="#授权与收回权限" class="headerlink" title="授权与收回权限"></a>授权与收回权限</h3><h5 id="授权"><a href="#授权" class="headerlink" title="授权"></a>授权</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># GRANT priv_type [(column_list)] ON database.table TO user [IDENTIFIED BY [PASSWORD] &#x27;password&#x27;]</span></span><br><span class="line"><span class="comment">#     [, user [IDENTIFIED BY [PASSWORD] &#x27;password&#x27;]] ... [WITH with_option [with_option] ...]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># with_option有几个权限值可选</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># - GRANT OPTION: 被授权的用户可以将这些权限赋予给别的用户</span></span><br><span class="line"><span class="comment"># - MAX_QUERIES_PER_HOUR count: 设置每小时可以允许执行count次查询</span></span><br><span class="line"><span class="comment"># - MAX_UPDATES_PER_HOUR count: 设置每小时可以允许执行count次更新</span></span><br><span class="line"><span class="comment"># - MAX_CONNECTIONS_PER_HOUR count: 设置每小时可以建立count连接</span></span><br><span class="line"><span class="comment"># - MAX_USER_CONNECTIONS count: 设置单个用户可以同时具有的count个连接数</span></span><br><span class="line"></span><br><span class="line">&gt; GRANT SELECT, UPDATE ON *.* TO <span class="string">&#x27;test5&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> IDENTIFIED BY <span class="string">&#x27;test5&#x27;</span> WITH GRANT OPTION;</span><br></pre></td></tr></table></figure>

<h5 id="收回权限"><a href="#收回权限" class="headerlink" title="收回权限"></a>收回权限</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">REVOKE priv_type [(column_list)] ... ON database.table FROM user [, user] ...</span><br><span class="line"></span><br><span class="line"><span class="comment"># 收回全部权限</span></span><br><span class="line">REVOKE ALL PRIVILEGES, GRANT OPTION FROM user [, user] ...</span><br></pre></td></tr></table></figure>

<h5 id="查看权限"><a href="#查看权限" class="headerlink" title="查看权限"></a>查看权限</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; SELECT * FROM mysql.user <span class="built_in">where</span> User=<span class="string">&#x27;xxxx&#x27;</span> and Host=<span class="string">&#x27;yyyy&#x27;</span>;</span><br><span class="line">&gt; SHOW GRANTS FOR <span class="string">&#x27;username&#x27;</span>@<span class="string">&#x27;hostname&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h2 id="数据备份与还原"><a href="#数据备份与还原" class="headerlink" title="数据备份与还原"></a>数据备份与还原</h2><h3 id="使用mysqldump命令备份"><a href="#使用mysqldump命令备份" class="headerlink" title="使用mysqldump命令备份"></a>使用mysqldump命令备份</h3><h5 id="备份一个数据库"><a href="#备份一个数据库" class="headerlink" title="备份一个数据库"></a>备份一个数据库</h5><p><code>mysqldump -u username -p dbname table1 table2 ... &gt; backup_name.sql</code></p>
<blockquote>
<p>不指定table1, table2时, 表示备份整个db</p>
</blockquote>
<h5 id="备份多个数据库"><a href="#备份多个数据库" class="headerlink" title="备份多个数据库"></a>备份多个数据库</h5><p><code>mysqldump -u username -p --databases dbname1 dbname2 ... &gt; backup_name.sql</code></p>
<h5 id="备份所有数据库"><a href="#备份所有数据库" class="headerlink" title="备份所有数据库"></a>备份所有数据库</h5><p><code>mysqldump -u username -p --all-databases &gt; backup_name.sql</code></p>
<h3 id="直接复制整个数据库目录"><a href="#直接复制整个数据库目录" class="headerlink" title="直接复制整个数据库目录"></a>直接复制整个数据库目录</h3><ul>
<li>这种方法最简单, 最快速, 但是使用这种方法最好将服务器先停止, 以保证在复制期间数据不发生变化.</li>
<li>这种方法对InnoDB存储引擎的表不适用, 只适用于MyISAM表</li>
<li>还原时最好是相同版本的MySQL数据库, 否则可能存在文件类型不同的情况</li>
</ul>
<h3 id="数据还原"><a href="#数据还原" class="headerlink" title="数据还原"></a>数据还原</h3><h5 id="使用mysql命令还原"><a href="#使用mysql命令还原" class="headerlink" title="使用mysql命令还原"></a>使用mysql命令还原</h5><p><code>mysql -u root -p [dbname] &lt; backup_name.sql</code></p>
<blockquote>
<ol>
<li>指定dbname, 表示还原该数据库下的表</li>
<li>不指定dbname, 表示还原sql中的所有数据库</li>
</ol>
</blockquote>
<h5 id="直接复制整个数据库目录-1"><a href="#直接复制整个数据库目录-1" class="headerlink" title="直接复制整个数据库目录"></a>直接复制整个数据库目录</h5><p>使用这个方式进行还原, 有上述使用该种方式备份时的种种限制, 请慎用</p>
<h3 id="数据迁移"><a href="#数据迁移" class="headerlink" title="数据迁移"></a>数据迁移</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqldump -h hostname1 -u root --password=password1 --all-databases | mysql -h hostname2 -u root --password=password2</span><br></pre></td></tr></table></figure>

<h3 id="表的导入导出"><a href="#表的导入导出" class="headerlink" title="表的导入导出"></a>表的导入导出</h3><h5 id="导出"><a href="#导出" class="headerlink" title="导出"></a>导出</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># SELECT [列名] FROM table [WHERE 语句] INTO OUTFILE &#x27;目标文件&#x27; [OPTION]</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># OPTION常用选项值</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># - FIELDS TERMINATED BY &#x27;字符串&#x27;: 设置字符串为字段的分隔符, 默认是&#x27;\t&#x27;</span></span><br><span class="line"><span class="comment"># - FIELDS ENCLOSED BY &#x27;字符&#x27;: 设置字符来括上字段的值, 默认不使用任何符号</span></span><br><span class="line"><span class="comment"># - FIELDS OPTIONALLY ENCLOSED BY &#x27;字符&#x27;: 设置字符来括上CHAR, VARCHAR和TEXT等字符型字段, 默认不使用任何符号</span></span><br><span class="line"><span class="comment"># - LINES STARTING BY &#x27;字符串&#x27;: 设置每行开头的字符, 默认情况不使用任何字符</span></span><br><span class="line"><span class="comment"># - FIELDS ESCAPED BY &#x27;字符&#x27;: 设置转移字符, 默认为&#x27;\&#x27;</span></span><br><span class="line"><span class="comment"># - LINES TERMINATED BY &#x27;字符串&#x27;: 设置每行的结束符, 默认值是&#x27;\n&#x27;</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># SELECT * FROM test.student INTO OUTFILE &#x27;/tmp/test.txt&#x27;</span></span><br><span class="line"><span class="comment">#     FIELDS TERMINATED BY &#x27;\,&#x27; OPTIONALLY ENCLOSED BY &#x27;\&quot;&#x27; LINES STARTING BY &#x27;\&gt;&#x27;</span></span><br><span class="line"><span class="comment">#     TERMINATED BY &#x27;\r\n&#x27;;</span></span><br></pre></td></tr></table></figure>

<h5 id="导入"><a href="#导入" class="headerlink" title="导入"></a>导入</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># LOAD DATA [LOCAL] INFILE file INTO TABLE table [OPTION];</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># OPTION常用选项值</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># - 导出小节所列选项值</span></span><br><span class="line"><span class="comment"># - IGNORE n LINES: 忽略文件的前n行记录;</span></span><br><span class="line"><span class="comment"># - (字段列表): 根据字段列表中的字段和顺序来加载记录</span></span><br><span class="line"><span class="comment"># - SET column=expr: 将制定的列column进行相应地转换后再加载, 使用expr表达式来进行转换</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># LODA DATA INFILE &#x27;/tmp/test.txt&#x27; INTO TABLE test.student FIELDS TERMINATED BY &#x27;,&#x27; OPTIONALLY ENCLOSED BY &quot;&#x27;&quot;;</span></span><br></pre></td></tr></table></figure>

<h2 id="日志"><a href="#日志" class="headerlink" title="日志"></a>日志</h2><p>除了bin log, 其余日志都是文本文件</p>
<p>默认情况只启用错误日志err log, 其他3类日志都需要数据库管理员进行设置</p>
<blockquote>
<p>如果MySQL数据库系统意外停止服务, 可以通过错误日志查看出现错误的原因. 并且, 可以通过bin log文件来查看用户执行了哪些操作<br>, 对数据库文件做了哪些修改. 然后, 可以根据bin log中的记录来修复数据库</p>
<p>但是, 启动log功能会降低MySQL数据库的执行速度. 例如, 一个查询操作比较频繁的MySQL中, 记录通用查询日志和慢查询日志要花费<br>很多的时间. 并且, log文件会占用大量的硬盘空间. 对于用户量非常大, 操作非常频繁的数据库, 日志文件需要的存储空间甚至比数<br>据库文件需要的存储空间还要大.</p>
</blockquote>
<h3 id="二进制日志-bin-log"><a href="#二进制日志-bin-log" class="headerlink" title="二进制日志(bin log)"></a>二进制日志(bin log)</h3><p>也叫update log, 主要用于记录数据库的变化情况. 通过bin log可以查询MySQL数据库进行了哪些改变.</p>
<h5 id="启动和设置bin-log"><a href="#启动和设置bin-log" class="headerlink" title="启动和设置bin log"></a>启动和设置bin log</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># my.cnf</span></span><br><span class="line">[mysqld]</span><br><span class="line">log-bin [=DIR \ [filename]]</span><br><span class="line"></span><br><span class="line">DIR: 指定bin <span class="built_in">log</span>的存储路径</span><br><span class="line">filename: 指定bin <span class="built_in">log</span>的文件名, 其形式为filename.number, 例如filename.000001, filename.000002等. 每次重启MySQL服务, 都会</span><br><span class="line">生成一个新的bin <span class="built_in">log</span>文件. 这些bin <span class="built_in">log</span>文件的<span class="string">&#x27;number&#x27;</span>会不断递增. 除了生成上述文件外, 还会生成一个名为filename.index的文件.</span><br><span class="line">这个文件中存储所有bin <span class="built_in">log</span>文件的清单.</span><br><span class="line"></span><br><span class="line">如果没有指定DIR, filename, bin <span class="built_in">log</span>将默认存储在数据库的数据目录下, 默认的文件名为hostname-bin.number, 其中hostname为主机</span><br><span class="line">名.</span><br></pre></td></tr></table></figure>

<p>bin log与数据库的数据文件最好不要放在同一块硬盘上. 即使数据文件所在的硬盘被破坏, 也可以使用另一块硬盘上的bin log来回复数<br>据文件. 两块硬盘同时坏了的可能性要小得多. 这样可以保证数据库中数据的安全.</p>
<h5 id="查看bin-log"><a href="#查看bin-log" class="headerlink" title="查看bin log"></a>查看bin log</h5><p><code>mysqlbinlog filename.number</code></p>
<h5 id="使用bin-log来还原数据库"><a href="#使用bin-log来还原数据库" class="headerlink" title="使用bin log来还原数据库"></a>使用bin log来还原数据库</h5><p><code>mysqlbinlog filename.number | mysql -u root -p</code></p>
<p>注意, 编号(number)小的文件开始还原</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysqlbinlog mylog.00001 | mysql -u root -p</span><br><span class="line">mysqlbinlog mylog.00002 | mysql -u root -p</span><br><span class="line">mysqlbinlog mylog.00003 | mysql -u root -p</span><br><span class="line">mysqlbinlog mylog.00004 | mysql -u root -p</span><br></pre></td></tr></table></figure>

<h5 id="暂停和重启bin-log功能"><a href="#暂停和重启bin-log功能" class="headerlink" title="暂停和重启bin log功能"></a>暂停和重启bin log功能</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SET SQL_LOG_BIN=0; <span class="comment"># 暂停</span></span><br><span class="line">SET SQL_LOG_BIN=1; <span class="comment"># 重新启用</span></span><br></pre></td></tr></table></figure>

<h3 id="错误日志-error-log"><a href="#错误日志-error-log" class="headerlink" title="错误日志(error log)"></a>错误日志(error log)</h3><p>err log是默认开启的, 并且无法被禁止. 默认存储路径为数据库的数据文件夹. 文件名通常为hostname.err.</p>
<p>存储路径可以通过 <code>log-error</code>选项来设置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># my.cnf</span></span><br><span class="line">[mysqld]</span><br><span class="line">log-error=DIR [/ filename]</span><br></pre></td></tr></table></figure>

<h3 id="通用查询日志"><a href="#通用查询日志" class="headerlink" title="通用查询日志"></a>通用查询日志</h3><p>通用查询日志是用来记录用户的所有操作, 包括启动和关闭MySQL服务, 更新语句和查询语句等.</p>
<p>默认文件名为hostname.log, 默认存储路径为数据库的数据文件夹.</p>
<p>默认情况下, 通用查询日志功能是关闭的. 可以通过下面方式设置开启</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># my.cnf</span></span><br><span class="line">[mysqld]</span><br><span class="line"><span class="built_in">log</span> [=DIR \ [filename]]</span><br></pre></td></tr></table></figure>

<h3 id="慢查询日志"><a href="#慢查询日志" class="headerlink" title="慢查询日志"></a>慢查询日志</h3><p>慢查询日志是用来记录执行时间超过指定时间的查询语句. 通过慢查询日志, 可以查找出哪些查询语句的执行效率很低, 以便进行优化.</p>
<p>默认该日志是关闭的. 默认存储路径为数据库的数据文件夹, 默认文件名为hostname-slow.log</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># my.cnf</span></span><br><span class="line">[mysqld]</span><br><span class="line">log-slow-queries [=DIR \ [filename]]</span><br><span class="line">long_query_time=n</span><br><span class="line"></span><br><span class="line"><span class="comment"># 执行时间超过n秒的语句会被记录下来, n不设置的话, 默认是10s</span></span><br></pre></td></tr></table></figure>

<h2 id="性能优化的有关概念"><a href="#性能优化的有关概念" class="headerlink" title="性能优化的有关概念"></a>性能优化的有关概念</h2><h3 id="优化简介"><a href="#优化简介" class="headerlink" title="优化简介"></a>优化简介</h3><p>db管理员可以使用<code>SHOW STATUS</code>语句查询MySQL的性能.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&gt; SHOW STATUS LIKE <span class="string">&#x27;value&#x27;</span>;</span><br><span class="line"></span><br><span class="line">value是以下几个常用统计参数</span><br><span class="line"></span><br><span class="line">- Connections: 连接MySQL服务器的次数</span><br><span class="line">- Uptime: MySQL服务器的上线时间</span><br><span class="line">- Slow_queries: 慢查询的次数</span><br><span class="line">- Com_select: 查询操作的次数</span><br><span class="line">- Com_insert: 插入操作的次数</span><br><span class="line">- Com_update: 更新操作的次数</span><br><span class="line">- Com_delete: 删除操作的次数</span><br></pre></td></tr></table></figure>

<h3 id="优化查询"><a href="#优化查询" class="headerlink" title="优化查询"></a>优化查询</h3><h4 id="分析查询语句"><a href="#分析查询语句" class="headerlink" title="分析查询语句"></a>分析查询语句</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&gt; EXPLAIN|DESCRIBE SELECT * FROM student \G;</span><br><span class="line">MariaDB [carltest]&gt; explain <span class="keyword">select</span> * from student \G;</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">           <span class="built_in">id</span>: 1</span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        table: student</span><br><span class="line">         <span class="built_in">type</span>: ALL</span><br><span class="line">possible_keys: NULL</span><br><span class="line">          key: NULL</span><br><span class="line">      key_len: NULL</span><br><span class="line">          ref: NULL</span><br><span class="line">         rows: 4</span><br><span class="line">        Extra:</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.24 sec)</span><br><span class="line"></span><br><span class="line">ERROR: No query specified</span><br><span class="line"></span><br><span class="line">MariaDB [carltest]&gt; desc <span class="keyword">select</span> * from student \G;</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">           <span class="built_in">id</span>: 1</span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        table: student</span><br><span class="line">         <span class="built_in">type</span>: ALL</span><br><span class="line">possible_keys: NULL</span><br><span class="line">          key: NULL</span><br><span class="line">      key_len: NULL</span><br><span class="line">          ref: NULL</span><br><span class="line">         rows: 4</span><br><span class="line">        Extra:</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">ERROR: No query specified</span><br></pre></td></tr></table></figure>

<ul>
<li>id: 表示select语句的编号</li>
<li>select_type: 表示select语句的类型. SIMPLE表示简单查询, 其中不包括子查询和连接查询; PRIMARY表示主查询, 或者是最外层的<br>        查询语句; UNION表示连接查询的第二个或后面的查询语句</li>
<li>table: 表示查询的表</li>
<li>type: 表示表的连接类型<blockquote>
<ul>
<li>system: 表示表中只有一条记录</li>
<li>const: 表示表中有多条记录, 但是只从表中查询一条记录</li>
<li>ALL: 表示对表进行了完整的扫描;</li>
<li>eq_ref: 表示多表连接时, 后面的表使用了UNIQUE或PRIMARY KEY</li>
<li>ref: 表示多表查询时, 后面的表使用了普通索引;</li>
<li>unique_subquery: 表示子查询中使用了UNIQUE或PRIMARY KEY</li>
<li>index_subquery: 表示子查询中使用了普通索引</li>
<li>range: 表示查询语句中给出了查询范围</li>
<li>index: 表示对表中的索引进行了完整的扫描</li>
</ul>
</blockquote>
</li>
<li>possible_keys: 表示查询中可能使用的索引</li>
<li>key: 表示查询使用到的索引</li>
<li>key_len: 表示索引字段的长度</li>
<li>ref: 表示使用哪个列或常数与索引一起来查询记录</li>
<li>rows: 表示查询的行数</li>
<li>Extra: 表示查询过程的附件信息</li>
</ul>
<h4 id="使用索引查询"><a href="#使用索引查询" class="headerlink" title="使用索引查询"></a>使用索引查询</h4><h5 id="注意下面添加索引前后-两次插叙-rows的结果-一个为4-一个为1"><a href="#注意下面添加索引前后-两次插叙-rows的结果-一个为4-一个为1" class="headerlink" title="注意下面添加索引前后, 两次插叙 rows的结果, 一个为4, 一个为1."></a>注意下面添加索引前后, 两次插叙 <code>rows</code>的结果, 一个为4, 一个为1.</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [carltest]&gt; explain <span class="keyword">select</span> * from student <span class="built_in">where</span> name=<span class="string">&quot;李四&quot;</span> \G;</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">           <span class="built_in">id</span>: 1</span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        table: student</span><br><span class="line">         <span class="built_in">type</span>: ALL</span><br><span class="line">possible_keys: NULL</span><br><span class="line">          key: NULL</span><br><span class="line">      key_len: NULL</span><br><span class="line">          ref: NULL</span><br><span class="line">         rows: 4</span><br><span class="line">        Extra: Using <span class="built_in">where</span></span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">ERROR: No query specified</span><br><span class="line"></span><br><span class="line">MariaDB [carltest]&gt; create index index_name on student(name);</span><br><span class="line">Query OK, 0 rows affected (0.44 sec)</span><br><span class="line">Records: 0  Duplicates: 0  Warnings: 0</span><br><span class="line"></span><br><span class="line">MariaDB [carltest]&gt; explain <span class="keyword">select</span> * from student <span class="built_in">where</span> name=<span class="string">&quot;李四&quot;</span> \G;</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">           <span class="built_in">id</span>: 1</span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        table: student</span><br><span class="line">         <span class="built_in">type</span>: ref</span><br><span class="line">possible_keys: index_name</span><br><span class="line">          key: index_name</span><br><span class="line">      key_len: 62</span><br><span class="line">          ref: const</span><br><span class="line">         rows: 1</span><br><span class="line">        Extra: Using index condition</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">ERROR: No query specified</span><br></pre></td></tr></table></figure>

<h5 id="LIKE关键字的使用方式-如果匹配字符串的第一个字符为’-’-索引不会被使用-否则-索引会被使用"><a href="#LIKE关键字的使用方式-如果匹配字符串的第一个字符为’-’-索引不会被使用-否则-索引会被使用" class="headerlink" title="LIKE关键字的使用方式. 如果匹配字符串的第一个字符为’%’, 索引不会被使用, 否则, 索引会被使用"></a>LIKE关键字的使用方式. 如果匹配字符串的第一个字符为’%’, 索引不会被使用, 否则, 索引会被使用</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [carltest]&gt; explain <span class="keyword">select</span> * from student <span class="built_in">where</span> name like <span class="string">&quot;%四&quot;</span> \G;</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">           <span class="built_in">id</span>: 1</span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        table: student</span><br><span class="line">         <span class="built_in">type</span>: ALL</span><br><span class="line">possible_keys: NULL</span><br><span class="line">          key: NULL</span><br><span class="line">      key_len: NULL</span><br><span class="line">          ref: NULL</span><br><span class="line">         rows: 4</span><br><span class="line">        Extra: Using <span class="built_in">where</span></span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">ERROR: No query specified</span><br><span class="line"></span><br><span class="line">MariaDB [carltest]&gt; explain <span class="keyword">select</span> * from student <span class="built_in">where</span> name like <span class="string">&quot;李%&quot;</span> \G;</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">           <span class="built_in">id</span>: 1</span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        table: student</span><br><span class="line">         <span class="built_in">type</span>: range</span><br><span class="line">possible_keys: index_name</span><br><span class="line">          key: index_name</span><br><span class="line">      key_len: 62</span><br><span class="line">          ref: NULL</span><br><span class="line">         rows: 1</span><br><span class="line">        Extra: Using index condition</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.06 sec)</span><br><span class="line"></span><br><span class="line">ERROR: No query specified</span><br></pre></td></tr></table></figure>

<h5 id="多列索引的用法-只有查询条件中使用了这些字段中第一个字段时-索引才会被使用"><a href="#多列索引的用法-只有查询条件中使用了这些字段中第一个字段时-索引才会被使用" class="headerlink" title="多列索引的用法. 只有查询条件中使用了这些字段中第一个字段时, 索引才会被使用."></a>多列索引的用法. 只有查询条件中使用了这些字段中第一个字段时, 索引才会被使用.</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [carltest]&gt; create index index_birth_department on student(birth, department);</span><br><span class="line">Query OK, 0 rows affected (0.12 sec)</span><br><span class="line">Records: 0  Duplicates: 0  Warnings: 0</span><br><span class="line"></span><br><span class="line">MariaDB [carltest]&gt; explain <span class="keyword">select</span> * from student <span class="built_in">where</span> birth=1991 \G;</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">           <span class="built_in">id</span>: 1</span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        table: student</span><br><span class="line">         <span class="built_in">type</span>: ref</span><br><span class="line">possible_keys: index_birth_department</span><br><span class="line">          key: index_birth_department</span><br><span class="line">      key_len: 2</span><br><span class="line">          ref: const</span><br><span class="line">         rows: 1</span><br><span class="line">        Extra:</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">ERROR: No query specified</span><br><span class="line"></span><br><span class="line">MariaDB [carltest]&gt; explain <span class="keyword">select</span> * from student <span class="built_in">where</span> department=<span class="string">&quot;英语系&quot;</span> \G;</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">           <span class="built_in">id</span>: 1</span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        table: student</span><br><span class="line">         <span class="built_in">type</span>: ALL</span><br><span class="line">possible_keys: NULL</span><br><span class="line">          key: NULL</span><br><span class="line">      key_len: NULL</span><br><span class="line">          ref: NULL</span><br><span class="line">         rows: 4</span><br><span class="line">        Extra: Using <span class="built_in">where</span></span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">ERROR: No query specified</span><br></pre></td></tr></table></figure>

<h5 id="OR关键字索引用法-OR前后两个条件的列都是索引时-查询将使用索引-只要有一列不是索引-那么查询就不会使用索引"><a href="#OR关键字索引用法-OR前后两个条件的列都是索引时-查询将使用索引-只要有一列不是索引-那么查询就不会使用索引" class="headerlink" title="OR关键字索引用法. OR前后两个条件的列都是索引时, 查询将使用索引. 只要有一列不是索引, 那么查询就不会使用索引"></a>OR关键字索引用法. OR前后两个条件的列都是索引时, 查询将使用索引. 只要有一列不是索引, 那么查询就不会使用索引</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [carltest]&gt; explain <span class="keyword">select</span> * from student <span class="built_in">where</span> name=<span class="string">&#x27;王六&#x27;</span> or sex=<span class="string">&#x27;女&#x27;</span> \G;</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">           <span class="built_in">id</span>: 1</span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        table: student</span><br><span class="line">         <span class="built_in">type</span>: ALL</span><br><span class="line">possible_keys: index_name</span><br><span class="line">          key: NULL</span><br><span class="line">      key_len: NULL</span><br><span class="line">          ref: NULL</span><br><span class="line">         rows: 4</span><br><span class="line">        Extra: Using <span class="built_in">where</span></span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">ERROR: No query specified</span><br><span class="line"></span><br><span class="line"><span class="comment"># id列是索引</span></span><br><span class="line">MariaDB [carltest]&gt; explain <span class="keyword">select</span> * from student <span class="built_in">where</span> name=<span class="string">&#x27;王六&#x27;</span> or <span class="built_in">id</span>=901 \G;</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">           <span class="built_in">id</span>: 1</span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        table: student</span><br><span class="line">         <span class="built_in">type</span>: ALL</span><br><span class="line">possible_keys: PRIMARY,index_name</span><br><span class="line">          key: NULL</span><br><span class="line">      key_len: NULL</span><br><span class="line">          ref: NULL</span><br><span class="line">         rows: 4</span><br><span class="line">        Extra: Using <span class="built_in">where</span></span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">ERROR: No query specified</span><br></pre></td></tr></table></figure>

<h5 id="MySQL参数优化"><a href="#MySQL参数优化" class="headerlink" title="MySQL参数优化"></a>MySQL参数优化</h5><table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>key_buffer_size</td>
<td>索引缓存的大小, 该值越大, 使用索引查询速度越快</td>
</tr>
<tr>
<td>table_cache</td>
<td>表示同时打开的表的个数. 该值越大, 能同时打开的表的个数越多. 但不是越大越好, 因为同时打开的表太多会影响操作系统的性能</td>
</tr>
<tr>
<td>query_cache_size</td>
<td>查询缓存区大小.</td>
</tr>
<tr>
<td>query_cache_type</td>
<td>查询缓冲区的开启状态. 0-关闭, 1-开启, 2-按要求使用</td>
</tr>
<tr>
<td>max_connections</td>
<td>数据库的最大连接数. 也不是越大越好, 太多连接会浪费内存资源</td>
</tr>
<tr>
<td>sort_buffer_size</td>
<td>排序缓冲区大小. 该值越大, 排序速度越快</td>
</tr>
<tr>
<td>innodb_buffer_pool_size</td>
<td>InnoDB类型的表和索引的最大缓存. 该值越大, 查询速度越快. 但是太大了也会影响系统性能</td>
</tr>
<tr>
<td>innodb_flush_log_at_trx_commit</td>
<td>0-每隔1s将数据写入log, 并将log写入磁盘; 1-每次提交事务时写log写磁盘; 2-每次提交事务时写log, 每隔1s将log写入磁盘, 默认值为1</td>
</tr>
</tbody></table>

    </div>

    
    
    

    <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2020/05/28/When-issued/" rel="prev" title="When issued 预发行交易">
                  <i class="fa fa-chevron-left"></i> When issued 预发行交易
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2020/12/27/RSA/" rel="next" title="RSA-数字签名与加密">
                  RSA-数字签名与加密 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>







<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">carl的修行--欢迎保留原文链接进行转载 :)</span>
</div>

    </div>
  </footer>

  
  <script src="//cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  






  





</body>
</html>
